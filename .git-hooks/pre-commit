#!/usr/bin/env sh
set -eu
set -o pipefail 2>/dev/null || true

echo "Running clang-formatâ€¦"

# Always go to repo root (safe)
cd "$(git rev-parse --show-toplevel)"

# Run make in src/
make -C src format

# Re-stage any changes made by formatting
if ! git diff --quiet; then
  echo "pre-commit: Formatting changed files."
  git add -A
fi
